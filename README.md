# Machine-Learning-2023-Fall

# 台北市 YouBike 預測專案

## 課程: 林軒田 機器學習 2023 Fall

## 團隊成員
- 資管二 B11705051 陳奕廷
- 資管二 B11705058 廖振翔
  
---

## 目錄
1. [專案介紹](#專案介紹)
2. [資料收集與預處理](#資料收集與預處理)
3. [模型選擇](#模型選擇)
4. [實作細節](#實作細節)
5. [效能比較](#效能比較)
6. [訓練過程詳情](#訓練過程詳情)
7. [模型選擇建議](#模型選擇建議)
8. [可能的改進方向](#可能的改進方向)
9. [附錄](#附錄)

---

## 專案介紹

### 背景介紹
此專案的目的是預測台北市多數 YouBike 車站的單車數量，並協助優化單車調度系統。

### 問題陳述
我們的目標是準確預測 112 個車站在每 20 分鐘內的單車數量。這是個時間序列預測問題，每個時間點的預測數值代表該車站的單車數量，且該數值需為非負整數。

---

## 資料收集與預處理

### 資料來源
- 來自 [YouBike2.0 Taipei City public bicycle real-time data](https://github.com/hyusterr/html.2023.final.data/tree/release)。
- 交通部中央氣象署提供的台北地區每日累積雨量及降雨時數資料，來源：[中央氣象局](https://www.cwa.gov.tw/V8/C/D/DailyPrecipitation.html)。

### 特徵選擇
除了使用專案提供的資料，我們還收集了台北地區的降雨時數與累積雨量數據，並加上了每個日期是星期幾的特徵。

以下是我們使用的特徵：
- 降雨時數
- 降雨量 (mm)
- 星期幾

---

## 模型選擇

### 線性回歸 (Linear Regression)
- **模型原理**：線性回歸模型假設目標變數（即每 20 分鐘的單車數量）與特徵之間存在線性關係。
- **優點**：簡單易懂，運算效率高，適用於線性關係較為明顯的情況。
- **限制**：對於非線性關係的資料預測準確性較低，且對異常值較為敏感。

### 隨機森林 (Random Forest)
- **模型原理**：隨機森林是一種集成學習方法，通過多棵決策樹的投票來提升模型性能。每棵樹都在隨機樣本的子集上訓練。
- **優點**：能處理大量特徵和高維數據，對於複雜的非線性關係有較好的適應性。
- **限制**：訓練時間較長，且可能會有過擬合問題，特別是對噪音數據敏感。

### XGBoost
- **模型原理**：XGBoost 是一種增強型梯度提升算法（Gradient Boosting），通過迭代訓練決策樹，每次修正前一棵樹的誤差。
- **優點**：能夠處理分類和回歸問題，效果通常優於其他模型。具有強大的抗噪聲能力。
- **限制**：訓練時間較長，並且解釋性較差。

---

## 實作細節

### 資料讀取
我們將提供的資料讀取進一個字典中，並以車站名稱為鍵來方便查詢。進行訓練的資料不使用 `date`、`open` 和 `bike_stop`，其中 `bike_stop` 用作字典的鍵，`open` 用來篩選開放的車站。

### 特徵讀取
我們通過 Excel 檔案讀取自己蒐集的額外特徵，如雨量和星期幾。這些特徵有助於提升模型的預測準確性。

### 訓練模型
最終選擇使用 XGBoost 作為訓練模型。經過多次實驗，我們選擇了 `n_estimators=200` 和 `learning_rate=0.1` 作為最佳參數。

### 預測
預測時，除了專案提供的資料外，我們還會使用氣象網站調取未來一週的降雨時數報告。然而，這些資料有時會與實際情況有較大差異。

---

## 效能比較

### 評估指標
我們使用 **均方誤差 (MSE)** 和 **R-squared** 來評估三種模型的效能。

### 訓練時間
- **線性回歸**：訓練速度非常快。
- **隨機森林與 XGBoost**：訓練時間較長，需要 4-5 小時。

### 預測時間
三種模型的預測時間相對較短，每次預測約需 20 分鐘。

---

## 訓練過程詳情

### 訓練方法
由於不同車站的需求和特性不同，我們為每個車站建立了獨立的模型，這樣我們總共訓練了超過 1300 個模型。

### 訓練流程
每個車站都有一個訓練模型，並使用該車站的驗證誤差來衡量模型的效能。

---

## 模型選擇建議

我們最終選擇了 **XGBoost** 作為主要的預測模型，並推薦此模型的原因如下：

- **卓越的預測性能**：XGBoost 在我們的測試中表現最優，並顯著減少了錯誤率。
- **處理噪音和缺失值的能力**：XGBoost 能夠有效處理噪音數據和缺失值，這對於現實世界的資料非常重要。
- **防止過擬合**：XGBoost 內建早停機制，能夠防止模型過擬合訓練數據。

---

## 可能的改進方向

### 擴展特徵集
我們可以增加更多特徵來提升模型的預測準確度，例如假日、大型活動或是交通狀況等因素。

### 使用更高效的模型
由於訓練過程是整個程式的瓶頸，我們希望未來能夠使用更高效的模型來加速訓練過程。

---

## 附錄

- **專案程式碼**：[GitHub 連結](https://github.com/Tim4x4x4/ML)
- **資料集資訊**：
  - [YouBike 資料集](https://github.com/hyusterr/html.2023.final.data/tree/release)
  - [中央氣象局資料](https://www.cwa.gov.tw/V8/C/D/DailyPrecipitation.html)
- **參考文獻**：
  - [XGBoost Paper](https://arxiv.org/pdf/1603.02754.pdf)
  - [XGBoost 文檔](https://docs.aws.amazon.com/zh_tw/sagemaker/latest/dg/xgboost-HowItWorks.html)
  - [ITHelp 文章](https://ithelp.ithome.com.tw/articles/10247936)

---
